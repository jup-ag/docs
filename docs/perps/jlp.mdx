---
title: "JLP"
description: "Understand Jupiter Liquidity Providers and how they work."
---

## What is JLP?

JLP (Jupiter Liquidity Provider) is the liquidity pool token that powers Jupiter Perpetuals. The JLP pool serves as the counterparty for all perpetual trades, providing liquidity for traders to open highly-leveraged positions up to 250x on SOL, WETH, and WBTC.

When you deposit assets into the JLP pool, you receive JLP tokens representing your share of the pool. As a liquidity provider, you earn 75% of fees generated by the perpetuals exchange, these fees are automatically and directly accrued into the JLP pool.

## How JLP Works with Perps

The JLP pool operates as a **trader-to-LP exchange model**, where:

### Pool-Based Liquidity
- **Single Liquidity Pool**: All liquidity comes from the JLP pool, not from resting orders or order books
- **Direct Trading**: Traders open and close positions directly against the pool
- **Unlimited Size**: Trade size is limited only by available pool liquidity and position-level constraints
- **Oracle-Based Pricing**: All trades execute at oracle prices, ensuring large trades don't affect prices for others

### Pool Composition
The JLP pool manages several custodies (tokens) for liquidity providers:

| Token | Custody Address |
|-------|----------------|
| **SOL** (Wrapped SOL) | [`7xS2gz2bTp3fwCC7knJvUWTEU9Tycczu6VhJYKgi1wdz`](https://solscan.io/account/7xS2gz2bTp3fwCC7knJvUWTEU9Tycczu6VhJYKgi1wdz) |
| **WWETH** (Wrapped WETHereum) | [`AQCGyheWPLeo6Qp9WpYS9m3Qj479t7R636N9ey1rEjEn`](https://solscan.io/account/AQCGyheWPLeo6Qp9WpYS9m3Qj479t7R636N9ey1rEjEn) |
| **WBTC** (Wrapped Bitcoin) | [`5Pv3gM9JrFFH883SWAhvJC9RPYmo8UNxuFtv5bMMALkm`](https://solscan.io/account/5Pv3gM9JrFFH883SWAhvJC9RPYmo8UNxuFtv5bMMALkm) |
| **USDC** (USD Coin) | [`G18jKKXQwBbrHeiK3C9MRXhkHsLHf7XgCSisykV46EZa`](https://solscan.io/account/G18jKKXQwBbrHeiK3C9MRXhkHsLHf7XgCSisykV46EZa) |

Each asset has a **target weightage** that the pool maintains through rebalancing mechanisms. The pool uses these assets to:
- Provide collateral backing for long positions (SOL, WWETH, WBTC)
- Provide collateral backing for short positions (USDC)
- Cover trader profits when positions are closed
- Earn fees for liquidity providers through trading and borrowing

### How Traders Interact with JLP
1. **Opening Positions**: When a trader opens a leveraged position, they deposit collateral and borrow the remaining position size from the JLP pool
2. **Closing Positions**: When positions are closed, profits are paid from the pool's assets, while losses are added to the pool
3. **Borrow Fees**: Traders pay continuous borrow fees to the pool based on their position size and the pool's utilization rate
4. **Trading Fees**: All open/close fees flow into the pool (with 25% going to the protocol)

The pool's AUM (Assets Under Management) represents the total value of assets in the pool, calculated as:

$$
\text{AUM} = \text{USD value of owned tokens} - \text{USD value reserved for trader profits}
$$

---

## Becoming a Liquidity Provider

To become a JLP liquidity provider, you need to mint JLP tokens by depositing one of the supported assets (SOL, WETH, WBTC, USDC) into the pool.
- JLP can be acquired through swapping on jup.ag which finds the best price either by other DEXes or the pool itself.
- Or through the [JLP Earn](https://jup.ag/perps/jlp-earn), which mints or burns JLP tokens directly from the pool.

<Note>
  For detailed instructions on minting and burning JLP tokens, refer to the [Getting JLP](/docs/perps/jlp/getting-jlp) guide.
</Note>

<Note>
  The pool has the following limits:

  - **AUM Limit**: The pool has a maximum AUM limit, preventing more deposits when the limit is hit.
  - **Token Weightage**: The pool maintains target weightages for each asset. Deposits/withdrawals that would push a token outside its target range (±20%) are restricted to maintain balance.
</Note>

---

## JLP Lending

JLP tokens can be used as collateral to borrow USDC from the pool, creating additional utility and yield opportunities for liquidity providers.

This feature allows liquidity providers to:
- Access liquidity without selling their JLP position
- Potentially increase their yield through leverage
- Maintain exposure to JLP returns while borrowing for other purposes

<Note>
  For detailed information on JLP lending mechanics, position management, and borrowing limits, refer to the [JLP Lend](/docs/perps/jlp-lend) documentation.
</Note>

---

## Economics

### Key Concepts

With the introduction of USDC lending from the JLP, the following definitions represent the true state of the custody accounts:

**Debt**
<Card>
$$
\text{debt} = \frac{\max\left(\text{custody.debt} - \text{custody.borrowLendInterestsAccrued},\ 0\right)}{1{,}000{,}000{,}000}
$$

The custody account's `debt` field represents the tokens borrowed from the custody.  
This gives the pure debt amount without accumulated interests.
</Card>

**Theoretically Owned**
<Card>
$$
\text{theoreticallyOwned} = \text{custody.assets.owned} + \text{debt}(\text{custody})
$$

This represents the "true" owned token amount by the custody.  
Borrowed tokens are not stored in `custody.assets.owned`, so this calculation provides the actual value of assets owned by the pool.
</Card>

**Total Locked**
<Card>
$$
totalLocked = custody.assets.locked + debt(custody)
$$

This represents the "true" locked token amount by the custody, including borrowed tokens:
Similar to the theoretically owned value above, this returns the actual locked token amount by the custody.
</Card>

---

### Assets Under Management

The AUM for each custody account in the pool is calculated as follows.

**Stablecoins (USDC)**
<Card>
$$
\text{aumUsd} = \text{theoreticallyOwned} \times \text{currentTokenPrice}
$$
</Card>

**Non-stablecoins (SOL, WETH, WBTC)**
1. First, calculate the global short position profit/loss (Unrealized PNL in USD).
2. Second, check if the short traders are in profit.
3. Finally, calculate the assets under management.
<Card>
$$
\text{unrealizedShortPNL} = \frac{\text{shortSize} \times \left| \text{shortAvgPrice} - \text{currentTokenPrice} \right|}{\text{shortAvgPrice}}
$$

1. Global short position profit/loss (Unrealized PNL in USD):
    - shortSize = `custody.assets.globalShortSizes`
    - shortAvgPrice = `custody.assets.globalShortAveragePrices`
</Card>

<Card>
2. Check if `shortAvgPrice > currentTokenPrice`. If true, short traders are in profit, otherwise they are in loss.
</Card>

<Card>
$$
\text{aumUsd} = \text{custody.assets.guaranteedUsd} \pm \text{unrealizedShortPNL}
$$

3. Assets under management for each asset:  

    - If the short traders are in profit, subtract `unrealizedShortPNL` from `aumUsd`.
    - Otherwise, add `unrealizedShortPNL` to `aumUsd`.

<Note>
- The `guaranteed_usd` value in each custody account represents an estimate of the total size of all long positions. It is only an estimate as `guaranteed_usd` is only updated when positions are updated (i.e. opening / closing positions, updating collateral). It does not update in real-time when asset prices change. 

- The `guaranteed_usd` value is used to calculate the pool's AUM as well as the overall PNL for all long positions efficiently.
</Note>
</Card>

**Total AUM**

The Total AUM is then calculated as the sum of all the custodies' AUM.

$$
\text{totalAumUsd} = \sum \text{aumUsd}
$$

---

### Virtual Price and Market Price

**Virtual Price**
<Card>
$$
\text{virtualPrice} = \frac{\text{totalAumUsd}}{\text{jlpTotalSupply}}
$$

The virtual price represents the intrinsic value of each JLP token based on the pool's underlying assets.
</Card>

**Market Price**
<Card>
$$
\text{marketPrice} = \text{virtualPrice} + \text{marketAssignedPremium}
$$

The market price of JLP is determined by supply and demand on the open market (e.g., through DEX swaps). It can differ from the virtual price depending on market conditions.

When the AUM limit is hit and deposits are restricted, liquidity providers will seek for circulating JLP in the open market, causing demand for JLP to exceed supply, leading to a market price premium above the virtual price.

<Note>
You may sell your JLP at market price any time (by swapping it with other tokens on DEXes). However, if Market Price is below the Virtual Price, your JLP will be redeemed (burned) at the virtual price instead.
</Note>
</Card>

---

### Global Realized PNL

1. Longs: uses locked tokens value minus guaranteed USD (collateral-based).
2. Shorts: uses size × absolute price difference divided by average entry price (price-difference-based).

<Tip>
Most accurate way to calculate the unrealized PNL for all open long/short positions is to loop through all open positions (by fetching them from onchain accounts) and use the unrealized PNL calculation shown below.
</Tip>

**Calculating Global Unrealized PNL for Longs**

To get an estimate of the global unrealized PNL for longs:

<Steps>
<Step>
<Card>
$$
\text{guaranteedUsd} = \text{custody.assets.guaranteedUsd}
$$

- [Using the custody account](/docs/perps/program/custody-account)
- Get the `assets.guaranteedUsd` field which stores the value of  
 `position.sizeUsd - position.collateralUsd` for all open long positions for the custody. 
- Note that a position's `sizeUsd` value is only updated when a trade is made, which is the 
  same for `guaranteedUsd` as well. It does *not* update in real-time when the custody's price changes.
</Card>
</Step>

<Step>
<Card>
$$
\text{lockedTokensUsd} = \text{custody.assets.locked} \times \text{currentTokenPriceUsd}
$$

- Multiply `custody.assets.locked` by the custody's current price to get the USD value of the tokens locked 
  by the pool to pay off traders' profits
</Card>
</Step>

<Step>
<Card>
$$
\text{globalUnrealizedLongPNL} = \text{lockedTokensUsd} - \text{guaranteedUsd}
$$

- Subtract `guaranteedUsd` from `lockedTokensUsd` to get the estimate of unrealized PNL for all open long positions.
- Note that the final value is greater than the actual unrealized PNL as it includes traders' collateral

</Card>
</Step>
</Steps>

**Calculating Global Unrealized PNL for Shorts**

To get an estimate of the global unrealized PNL for shorts:

<Steps>
<Step>
<Card>
$$
\text{globalShortSizes} = \text{custody.assets.globalShortSizes}
$$

$$
\text{globalShortAveragePrices} = \text{custody.assets.globalShortAveragePrices}
$$

- [Using the custody account](/docs/perps/program/custody-account)
- Get the `assets.globalShortSizes` field which represents the total USD value of all open short positions.
- Get the `assets.globalShortAveragePrices` field which represents the average entry price (in USD) of all open short positions.
</Card>
</Step>

<Step>
<Card>
$$
\text{priceDifferenceRatio} = \frac{
  \left| \text{globalShortAveragePrices} - \text{currentTokenPriceUsd} \right|
}{
  \text{globalShortAveragePrices}
}
$$

- Calculate the absolute price difference ratio between the average entry price and the current token price.
- This represents the percentage change in price since the average entry.
</Card>
</Step>

<Step>
<Card>
$$
\text{globalUnrealizedShortPNL} = \text{globalShortSizes} \times \text{priceDifferenceRatio}
$$

- Multiply `globalShortSizes` by `priceDifferenceRatio` to get the estimate of unrealized PNL for all open short positions.
</Card>
</Step>
</Steps>

---
